name: PR title check

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

jobs:
  check-title:
    runs-on: ubuntu-latest
    steps:
      - name: Validate PR title
        env:
          PR_TITLE: ${{ github.event.pull_request.title }}
        run: |
          PATTERN='^(feat|fix|chore|refactor|docs|test|bump|hotfix): .+'
          if ! printf '%s' "$PR_TITLE" | grep -qE "$PATTERN"; then
            echo "ERROR: PR title does not match the required format."
            echo ""
            echo "Expected: <type>: <description>"
            echo "Types: feat, fix, chore, refactor, docs, test, bump, hotfix"
            echo ""
            echo "Examples:"
            echo "  feat: add changelog to update dialog"
            echo "  fix: null pointer on app release ingest"
            echo "  bump: 1.0.9"
            echo ""
            echo "Got: $PR_TITLE"
            exit 1
          fi
